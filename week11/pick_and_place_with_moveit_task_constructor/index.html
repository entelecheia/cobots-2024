
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MoveIt Task Constructor를 사용한 집어서 놓기 &#8212; 협동로봇활용 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BQJE5V9RK2"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BQJE5V9RK2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BQJE5V9RK2');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week11/pick_and_place_with_moveit_task_constructor/index';</script>
    <link rel="icon" href="https://assets.entelecheia.ai/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Week 12" href="../../week12/index.html" />
    <link rel="prev" title="물체 주변 계획하기" href="../planning_around_objects/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">협동로봇활용 2024</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    Home
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week01/index.html">Week 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week01/lecture.html">두산로보틱스 기본 교육</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/terminology.html">주요용어</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/references.html">참고자료</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week01/review.html">복습</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week02/index.html">Week 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week02/lecture.html">핵심 교육 (Part 1/2)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week03/index.html">Week 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week03/lecture.html">핵심 교육 (Part 1/2)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/ros-intro.html">ROS 소개</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/ros-setup.html">ROS 설치환경 구축하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week03/ros-install.html">ROS 설치하기</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week04/index.html">Week 4</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week04/lecture.html">핵심 교육 (Part 2/2)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week05/index.html">Week 5</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week05/lecture.html">ROS 활용방법</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week06/index.html">Week 6</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week06/ros-container.html">도커를 이용한 ROS2 실행환경 구축</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/ros-setup.html">ROS 환경 설정</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/dsr-usage.html">DSR 사용방법</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week06/ros-intro.html">ROS 소개</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week07/index.html">Week 7</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week07/ros-basics.html">ROS 기초</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week07/ros-workspace.html">패키지와 워크스페이스</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week09/index.html">Week 9</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week09/configure.html">ROS 2 환경 구성하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/intro-turtlesim.html"><code class="docutils literal notranslate"><span class="pre">turtlesim</span></code>, <code class="docutils literal notranslate"><span class="pre">ros2</span></code>, 그리고 <code class="docutils literal notranslate"><span class="pre">rqt</span></code> 사용하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week09/nodes.html">노드 이해하기</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week10/index.html">Week 10</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week10/getting_started.html">MoveIt 2 시작하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week10/quickstart_in_rviz/index.html">RViz에서 MoveIt 빠르게 시작하기</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week10/your_first_project/index.html">첫 번째 C++ MoveIt 프로젝트</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week10/visualizing_in_rviz/index.html">RViz에서 시각화하기</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">Week 11</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../planning_around_objects/index.html">물체 주변 계획하기</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">MoveIt Task Constructor를 사용한 집어서 놓기</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week12/index.html">Week 12</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week12/kinematics.html">운동학 (Kinematics)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week12/motion_planning.html">모션 플래닝 (Motion Planning)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week12/hybrid_planning.html">하이브리드 플래닝 (Hybrid Planning)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week13/index.html">Week 13</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week13/move_group.html"><code class="docutils literal notranslate"><span class="pre">move_group</span></code> 노드</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week13/planning_scene_monitor.html">플래닝 Scene 모니터</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week13/trajectory_processing.html">궤적 처리</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week13/moveit_task_constructor.html">MoveIt 작업 생성기(Task Constructor)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../week14/index.html">Week 14</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../week14/motion_planning_python_api/index.html">모션 플래닝 Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week14/jupyter_notebook_prototyping/index.html">Jupyter 노트북을 사용한 프로토타이핑</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../week14/jupyter_notebook_prototyping/src/moveit_notebook_tutorial.html">MoveIt Notebook Tutorial</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../projects/index.html">ROS 프로젝트</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../projects/202021024/index.html">202021024 - 로봇팔을 이용한 덤벨 및 원판 정리</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/202021029/index.html">202021029 - 로봇 팔을 활용한 자동 물체 이송 시스템</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/202021038/index.html">202021038 - 로봇 팔을 활용한 분리수거 자동화</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/202121010/index.html">202121010 - 로봇 팔을 통한 과일 선별 과정 자동화</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../projects/202221014/index.html">202221014 - 로봇을 이용한 정원 관리</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects/setup.html">프로젝트 환경설정</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../syllabus/index.html">수업계획서</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">만든 사람들</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://halla.ai">인공지능학과</a></li>
<li class="toctree-l1"><a class="reference external" href="https://os2024.halla.ai">운영체제 2024</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mlops2024.halla.ai">머신러닝시스템 2024</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cobots2024.halla.ai">협동로봇활용 2024</a></li>
<li class="toctree-l1"><a class="reference external" href="https://aibasics.halla.ai">AI 세상 속으로</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/chu-aie/cobots-2024" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/chu-aie/cobots-2024/edit/main/src/cobots2024/book/week11/pick_and_place_with_moveit_task_constructor/index.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/chu-aie/cobots-2024/issues/new?title=Issue%20on%20page%20%2Fweek11/pick_and_place_with_moveit_task_constructor/index.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/week11/pick_and_place_with_moveit_task_constructor/index.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MoveIt Task Constructor를 사용한 집어서 놓기</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">시작하기</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">MoveIt Task Constructor 다운로드</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">새 패키지 만들기</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">MoveIt Task Constructor를 사용한 프로젝트 설정</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">코드</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">코드 분석</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">데모 실행</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">실행 파일</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rviz">RViz 구성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">데모 실행</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">스테이지 추가</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">집기 스테이지</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">놓기 스테이지</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">RViz로 시각화</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">터미널에서 디버깅</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">다양한 힌트</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">요약</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="moveit-task-constructor">
<h1>MoveIt Task Constructor를 사용한 집어서 놓기<a class="headerlink" href="#moveit-task-constructor" title="Link to this heading">#</a></h1>
<p>이 강의에서는 <a class="reference external" href="https://github.com/ros-planning/moveit_task_constructor/tree/ros2/">MoveIt Task Constructor</a>를 사용하여 집어서 놓기 작업을 계획하는 패키지를 만드는 과정을 안내합니다. MoveIt Task Constructor는 여러 개의 하위 작업(스테이지라고 함)으로 구성된 작업을 계획하는 방법을 제공합니다.</p>
<video width="700px" controls="true" autoplay="true" loop="true">
    <source src="../../assets/video/mtc-demo.webm" type="video/webm">
</video>
<section id="id1">
<h2>시작하기<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<section id="id2">
<h3>MoveIt Task Constructor 다운로드<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Colcon 작업 공간으로 이동하여 MoveIt Task Constructor 소스를 가져옵니다:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/ws_moveit2/src
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ros-planning/moveit_task_constructor.git<span class="w"> </span>-b<span class="w"> </span>ros2
</pre></div>
</div>
</section>
<section id="id3">
<h3>새 패키지 만들기<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>다음 명령을 사용하여 새 패키지를 만듭니다:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>pkg<span class="w"> </span>create<span class="w"> </span>--build-type<span class="w"> </span>ament_cmake<span class="w"> </span>--node-name<span class="w"> </span>mtc_tutorial<span class="w"> </span>mtc_tutorial
</pre></div>
</div>
<p>이렇게 하면 <code class="docutils literal notranslate"><span class="pre">mtc_tutorial</span></code>이라는 새 폴더가 생성되고 <code class="docutils literal notranslate"><span class="pre">src/mtc_node</span></code>에 Hello World 예제가 포함됩니다. 다음으로 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code>에 의존성을 추가합니다. 다음과 유사해야 합니다:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="cp">&lt;?xml-model href=&quot;http://download.ros.org/schema/package_format3.xsd&quot; schematypens=&quot;http://www.w3.org/2001/XMLSchema&quot;?&gt;</span>
<span class="nt">&lt;package</span><span class="w"> </span><span class="na">format=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;name&gt;</span>mtc_tutorial<span class="nt">&lt;/name&gt;</span>
<span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;description&gt;</span>TODO:<span class="w"> </span>Package<span class="w"> </span>description<span class="nt">&lt;/description&gt;</span>
<span class="nt">&lt;maintainer</span><span class="w"> </span><span class="na">email=</span><span class="s">&quot;youremail@domain.com&quot;</span><span class="nt">&gt;</span>user<span class="nt">&lt;/maintainer&gt;</span>
<span class="nt">&lt;license&gt;</span>TODO:<span class="w"> </span>License<span class="w"> </span>declaration<span class="nt">&lt;/license&gt;</span>

<span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>

<span class="nt">&lt;depend&gt;</span>moveit_task_constructor_core<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>

<span class="nt">&lt;test_depend&gt;</span>ament_lint_auto<span class="nt">&lt;/test_depend&gt;</span>
<span class="nt">&lt;test_depend&gt;</span>ament_lint_common<span class="nt">&lt;/test_depend&gt;</span>

<span class="nt">&lt;export&gt;</span>
<span class="w">    </span><span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
<p>또한 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>에도 의존성을 추가합니다. 파일은 다음과 유사해야 합니다:</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.8</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">mtc_tutorial</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="c"># find dependencies</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">moveit_task_constructor_core</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c"># uncomment the following section in order to fill in</span>
<span class="c"># further dependencies manually.</span>
<span class="c"># find_package(&lt;dependency&gt; REQUIRED)</span>

<span class="nb">add_executable</span><span class="p">(</span><span class="s">mtc_tutorial</span><span class="w"> </span><span class="s">src/mtc_tutorial.cpp</span><span class="p">)</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">mtc_tutorial</span><span class="w"> </span><span class="s">moveit_task_constructor_core</span><span class="w"> </span><span class="s">rclcpp</span><span class="p">)</span>
<span class="nb">target_include_directories</span><span class="p">(</span><span class="s">mtc_tutorial</span><span class="w"> </span><span class="s">PUBLIC</span>
<span class="o">$&lt;</span><span class="nv">BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include</span><span class="o">&gt;</span>
<span class="o">$&lt;</span><span class="nv">INSTALL_INTERFACE:include</span><span class="o">&gt;</span><span class="p">)</span>
<span class="nb">target_compile_features</span><span class="p">(</span><span class="s">mtc_tutorial</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">c_std_99</span><span class="w"> </span><span class="s">cxx_std_17</span><span class="p">)</span><span class="w">  </span><span class="c"># Require C99 and C++17</span>

<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">mtc_tutorial</span>
<span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>

<span class="nb">if</span><span class="p">(</span><span class="s">BUILD_TESTING</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_lint_auto</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c"># the following line skips the linter which checks for copyrights</span>
<span class="c"># uncomment the line when a copyright and license is not present in all source files</span>
<span class="c">#set(ament_cmake_copyright_FOUND TRUE)</span>
<span class="c"># the following line skips cpplint (only works in a git repo)</span>
<span class="c"># uncomment the line when this package is not in a git repo</span>
<span class="c">#set(ament_cmake_cpplint_FOUND TRUE)</span>
<span class="nb">ament_lint_auto_find_test_dependencies</span><span class="p">()</span>
<span class="nb">endif</span><span class="p">()</span>

<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h2>MoveIt Task Constructor를 사용한 프로젝트 설정<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>이 섹션에서는 MoveIt Task Constructor를 사용하여 최소한의 작업을 구축하는 데 필요한 코드를 살펴봅니다.</p>
<section id="id5">
<h3>코드<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>선택한 편집기에서 <code class="docutils literal notranslate"><span class="pre">mtc_tutorial.cpp</span></code>를 열고 다음 코드를 붙여넣습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;rclcpp/rclcpp.hpp&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;moveit/planning_scene/planning_scene.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;moveit/planning_scene_interface/planning_scene_interface.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;moveit/task_constructor/task.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;moveit/task_constructor/solvers.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;moveit/task_constructor/stages.h&gt;</span>
<span class="cp">#if __has_include(&lt;tf2_geometry_msgs/tf2_geometry_msgs.hpp&gt;)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tf2_geometry_msgs/tf2_geometry_msgs.hpp&gt;</span>
<span class="cp">#else</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tf2_geometry_msgs/tf2_geometry_msgs.h&gt;</span>
<span class="cp">#endif</span>
<span class="cp">#if __has_include(&lt;tf2_eigen/tf2_eigen.hpp&gt;)</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tf2_eigen/tf2_eigen.hpp&gt;</span>
<span class="cp">#else</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tf2_eigen/tf2_eigen.h&gt;</span>
<span class="cp">#endif</span>

<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;mtc_tutorial&quot;</span><span class="p">);</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">mtc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">moveit</span><span class="o">::</span><span class="nn">task_constructor</span><span class="p">;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MTCTaskNode</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MTCTaskNode</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">);</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">node_interfaces</span><span class="o">::</span><span class="n">NodeBaseInterface</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="nf">getNodeBaseInterface</span><span class="p">();</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">doTask</span><span class="p">();</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">setupPlanningScene</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// Compose an MTC task from a series of stages.</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">createTask</span><span class="p">();</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">task_</span><span class="p">;</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">node_</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">rclcpp</span><span class="o">::</span><span class="n">node_interfaces</span><span class="o">::</span><span class="n">NodeBaseInterface</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="nf">MTCTaskNode::getNodeBaseInterface</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">node_</span><span class="o">-&gt;</span><span class="n">get_node_base_interface</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">MTCTaskNode</span><span class="o">::</span><span class="n">MTCTaskNode</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">)</span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">node_</span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;mtc_node&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">MTCTaskNode</span><span class="o">::</span><span class="n">setupPlanningScene</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">moveit_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">CollisionObject</span><span class="w"> </span><span class="n">object</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;object&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SolidPrimitive</span><span class="o">::</span><span class="n">CYLINDER</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">dimensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="w"> </span><span class="n">pose</span><span class="p">;</span>
<span class="w">  </span><span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">  </span><span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.25</span><span class="p">;</span>
<span class="w">  </span><span class="n">pose</span><span class="p">.</span><span class="n">orientation</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">pose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pose</span><span class="p">;</span>

<span class="w">  </span><span class="n">moveit</span><span class="o">::</span><span class="n">planning_interface</span><span class="o">::</span><span class="n">PlanningSceneInterface</span><span class="w"> </span><span class="n">psi</span><span class="p">;</span>
<span class="w">  </span><span class="n">psi</span><span class="p">.</span><span class="n">applyCollisionObject</span><span class="p">(</span><span class="n">object</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="n">MTCTaskNode</span><span class="o">::</span><span class="n">doTask</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">task_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createTask</span><span class="p">();</span>

<span class="w">  </span><span class="k">try</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">task_</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">InitStageException</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">task_</span><span class="p">.</span><span class="n">plan</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Task planning failed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">task_</span><span class="p">.</span><span class="n">introspection</span><span class="p">().</span><span class="n">publishSolution</span><span class="p">(</span><span class="o">*</span><span class="n">task_</span><span class="p">.</span><span class="n">solutions</span><span class="p">().</span><span class="n">front</span><span class="p">());</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">task_</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">task_</span><span class="p">.</span><span class="n">solutions</span><span class="p">().</span><span class="n">front</span><span class="p">());</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">val</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">moveit_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MoveItErrorCodes</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Task execution failed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">MTCTaskNode</span><span class="o">::</span><span class="n">createTask</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">stages</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">setName</span><span class="p">(</span><span class="s">&quot;demo task&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">loadRobotModel</span><span class="p">(</span><span class="n">node_</span><span class="p">);</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">arm_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;panda_arm&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">hand_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hand&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">hand_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;panda_hand&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Set task properties</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">arm_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;ik_frame&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>

<span class="c1">// Disable warnings for this line, as it&#39;s a variable that&#39;s set but not used in this example</span>
<span class="cp">#pragma GCC diagnostic push</span>
<span class="cp">#pragma GCC diagnostic ignored &quot;-Wunused-but-set-variable&quot;</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">*</span><span class="w"> </span><span class="n">current_state_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w">  </span><span class="c1">// Forward current_state on to grasp pose generator</span>
<span class="cp">#pragma GCC diagnostic pop</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_state_current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">CurrentState</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;current&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">current_state_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stage_state_current</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_state_current</span><span class="p">));</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">sampling_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">PipelinePlanner</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node_</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">JointInterpolationPlanner</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">cartesian_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">CartesianPath</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setMaxVelocityScalingFactor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setMaxAccelerationScalingFactor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setStepSize</span><span class="p">(</span><span class="mf">.01</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_open_hand</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;open hand&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;open&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_open_hand</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="w"> </span><span class="n">options</span><span class="p">;</span>
<span class="w">  </span><span class="n">options</span><span class="p">.</span><span class="n">automatically_declare_parameters_from_overrides</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">mtc_task_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">MTCTaskNode</span><span class="o">&gt;</span><span class="p">(</span><span class="n">options</span><span class="p">);</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">executors</span><span class="o">::</span><span class="n">MultiThreadedExecutor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">spin_thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">&gt;</span><span class="p">([</span><span class="o">&amp;</span><span class="n">executor</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mtc_task_node</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">getNodeBaseInterface</span><span class="p">());</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">spin</span><span class="p">();</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">getNodeBaseInterface</span><span class="p">());</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">setupPlanningScene</span><span class="p">();</span>
<span class="w">  </span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">doTask</span><span class="p">();</span>

<span class="w">  </span><span class="n">spin_thread</span><span class="o">-&gt;</span><span class="n">join</span><span class="p">();</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>코드 분석<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>코드 상단에는 이 패키지에서 사용하는 ROS 및 MoveIt 라이브러리가 포함되어 있습니다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rclcpp/rclcpp.hpp</span></code>에는 핵심 ROS 2 기능이 포함되어 있습니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">moveit/planning_scene/planning_scene.h</span></code> 및 <code class="docutils literal notranslate"><span class="pre">moveit/planning_scene_interface/planning_scene_interface.h</span></code>에는 로봇 모델 및 충돌 객체와 상호 작용하기 위한 기능이 포함되어 있습니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">moveit/task_constructor/task.h</span></code>, <code class="docutils literal notranslate"><span class="pre">moveit/task_constructor/solvers.h</span></code> 및 <code class="docutils literal notranslate"><span class="pre">moveit/task_constructor/stages.h</span></code>에는 예제에서 사용되는 MoveIt Task Constructor의 다양한 구성 요소가 포함되어 있습니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf2_geometry_msgs/tf2_geometry_msgs.hpp</span></code> 및 <code class="docutils literal notranslate"><span class="pre">tf2_eigen/tf2_eigen.hpp</span></code>는 이 초기 예제에서는 사용되지 않지만, MoveIt Task Constructor 작업에 더 많은 스테이지를 추가할 때 자세 생성에 사용될 것입니다.</p></li>
</ul>
<p>다음 줄에서는 새 노드에 대한 로거를 가져옵니다. 또한 편의를 위해 <code class="docutils literal notranslate"><span class="pre">moveit::task_constructor</span></code>에 대한 네임스페이스 별칭을 만듭니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Logger</span><span class="w"> </span><span class="n">LOGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">get_logger</span><span class="p">(</span><span class="s">&quot;mtc_tutorial&quot;</span><span class="p">);</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">mtc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">moveit</span><span class="o">::</span><span class="nn">task_constructor</span><span class="p">;</span>
</pre></div>
</div>
<p>MoveIt Task Constructor의 주요 기능을 포함할 클래스를 정의하여 시작합니다. 또한 MoveIt Task Constructor 작업 객체를 클래스의 멤버 변수로 선언합니다. 이는 주어진 애플리케이션에 반드시 필요한 것은 아니지만, 나중에 시각화를 위해 작업을 저장하는 데 도움이 됩니다. 아래에서 각 함수를 개별적으로 살펴보겠습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MTCTaskNode</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MTCTaskNode</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">);</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">node_interfaces</span><span class="o">::</span><span class="n">NodeBaseInterface</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="nf">getNodeBaseInterface</span><span class="p">();</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">doTask</span><span class="p">();</span>

<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">setupPlanningScene</span><span class="p">();</span>

<span class="k">private</span><span class="o">:</span>
<span class="w">  </span><span class="c1">// Compose an MTC task from a series of stages.</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">createTask</span><span class="p">();</span>
<span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">task_</span><span class="p">;</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">node_</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>이 줄은 나중에 실행기에 사용될 노드 기본 인터페이스를 가져오는 getter 함수를 정의합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">rclcpp</span><span class="o">::</span><span class="n">node_interfaces</span><span class="o">::</span><span class="n">NodeBaseInterface</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="nf">MTCTaskNode::getNodeBaseInterface</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">node_</span><span class="o">-&gt;</span><span class="n">get_node_base_interface</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>다음 줄은 지정된 옵션으로 노드를 초기화합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">MTCTaskNode</span><span class="o">::</span><span class="n">MTCTaskNode</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">)</span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">node_</span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;mtc_node&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>이 클래스 메서드는 예제에 사용되는 계획 장면을 설정하는 데 사용됩니다. <code class="docutils literal notranslate"><span class="pre">object.primitives[0].dimensions</span></code>로 지정된 치수와 <code class="docutils literal notranslate"><span class="pre">pose.position.z</span></code> 및 <code class="docutils literal notranslate"><span class="pre">pose.position.x</span></code>로 지정된 위치를 사용하여 실린더를 만듭니다. 이 숫자를 변경하여 실린더의 크기를 조정하고 이동할 수 있습니다. 실린더를 로봇의 도달 범위 밖으로 이동하면 계획이 실패합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">MTCTaskNode::setupPlanningScene</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">moveit_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">CollisionObject</span><span class="w"> </span><span class="n">object</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;object&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">SolidPrimitive</span><span class="o">::</span><span class="n">CYLINDER</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">dimensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="w"> </span><span class="p">};</span>

<span class="w">  </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Pose</span><span class="w"> </span><span class="n">pose</span><span class="p">;</span>
<span class="w">  </span><span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">  </span><span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.25</span><span class="p">;</span>
<span class="w">  </span><span class="n">object</span><span class="p">.</span><span class="n">pose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pose</span><span class="p">;</span>

<span class="w">  </span><span class="n">moveit</span><span class="o">::</span><span class="n">planning_interface</span><span class="o">::</span><span class="n">PlanningSceneInterface</span><span class="w"> </span><span class="n">psi</span><span class="p">;</span>
<span class="w">  </span><span class="n">psi</span><span class="p">.</span><span class="n">applyCollisionObject</span><span class="p">(</span><span class="n">object</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>이 함수는 MoveIt Task Constructor 작업 객체와 상호 작용합니다. 먼저 작업을 생성하는데, 여기에는 일부 속성 설정과 스테이지 추가가 포함됩니다. 이에 대해서는 <code class="docutils literal notranslate"><span class="pre">createTask</span></code> 함수 정의에서 더 자세히 다룰 것입니다. 다음으로 <code class="docutils literal notranslate"><span class="pre">task.init()</span></code>는 작업을 초기화하고 <code class="docutils literal notranslate"><span class="pre">task.plan(5)</span></code>는 5개의 성공적인 계획이 발견될 때까지 계획을 생성합니다. 다음 줄은 RViz에서 시각화할 솔루션을 게시합니다. 시각화가 필요하지 않은 경우 이 줄을 제거할 수 있습니다. 마지막으로 <code class="docutils literal notranslate"><span class="pre">task.execute()</span></code>는 계획을 실행합니다. 실행은 RViz 플러그인과의 액션 서버 인터페이스를 통해 수행됩니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">MTCTaskNode::doTask</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">task_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createTask</span><span class="p">();</span>

<span class="w">  </span><span class="k">try</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">task_</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">InitStageException</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">task_</span><span class="p">.</span><span class="n">plan</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Task planning failed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">task_</span><span class="p">.</span><span class="n">introspection</span><span class="p">().</span><span class="n">publishSolution</span><span class="p">(</span><span class="o">*</span><span class="n">task_</span><span class="p">.</span><span class="n">solutions</span><span class="p">().</span><span class="n">front</span><span class="p">());</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">task_</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">task_</span><span class="p">.</span><span class="n">solutions</span><span class="p">().</span><span class="n">front</span><span class="p">());</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">val</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">moveit_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">MoveItErrorCodes</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">RCLCPP_ERROR_STREAM</span><span class="p">(</span><span class="n">LOGGER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Task execution failed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>위에서 언급했듯이 이 함수는 MoveIt Task Constructor 객체를 생성하고 초기 속성을 설정합니다. 이 경우 작업 이름을 “demo_task”로 설정하고 로봇 모델을 로드하며 일부 유용한 프레임의 이름을 정의하고 <code class="docutils literal notranslate"><span class="pre">task.setProperty(property_name,</span> <span class="pre">value)</span></code>를 사용하여 해당 프레임 이름을 작업의 속성으로 설정합니다. 다음 몇 개의 코드 블록에서는 이 함수 본문을 채울 것입니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">mtc</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="nf">MTCTaskNode::createTask</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">moveit</span><span class="o">::</span><span class="n">task_constructor</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">stages</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">setName</span><span class="p">(</span><span class="s">&quot;demo task&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">loadRobotModel</span><span class="p">(</span><span class="n">node_</span><span class="p">);</span>

<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">arm_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;panda_arm&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">hand_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hand&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="o">&amp;</span><span class="w"> </span><span class="n">hand_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;panda_hand&quot;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Set task properties</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">arm_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s">&quot;ik_frame&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>
</pre></div>
</div>
<p>이제 노드에 예제 스테이지를 추가합니다. 첫 번째 줄은 <code class="docutils literal notranslate"><span class="pre">current_state_ptr</span></code>을 <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>로 설정합니다. 이렇게 하면 특정 시나리오에서 스테이지 정보를 재사용할 수 있도록 스테이지에 대한 포인터가 생성됩니다. 이 줄은 현재 사용되지 않지만 나중에 작업에 더 많은 스테이지를 추가할 때 사용됩니다. 다음으로 <code class="docutils literal notranslate"><span class="pre">current_state</span></code> 스테이지(생성기 스테이지)를 만들고 작업에 추가합니다. 이렇게 하면 로봇이 현재 상태에서 시작됩니다. 이제 <code class="docutils literal notranslate"><span class="pre">CurrentState</span></code> 스테이지를 생성했으므로 나중에 사용할 수 있도록 <code class="docutils literal notranslate"><span class="pre">current_state_ptr</span></code>에 포인터를 저장합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">*</span><span class="w"> </span><span class="n">current_state_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w">  </span><span class="c1">// Forward current_state on to grasp pose generator</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_state_current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">CurrentState</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;current&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">current_state_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stage_state_current</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_state_current</span><span class="p">));</span>
</pre></div>
</div>
<p>로봇 모션을 계획하려면 솔버를 지정해야 합니다. MoveIt Task Constructor에는 솔버에 대한 세 가지 옵션이 있습니다:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PipelinePlanner</span></code>는 일반적으로 OMPL로 기본 설정되는 MoveIt의 계획 파이프라인을 사용합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CartesianPath</span></code>는 카테시안 공간에서 엔드 이펙터를 직선으로 이동하는 데 사용됩니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JointInterpolation</span></code>은 시작 관절 상태와 목표 관절 상태 사이를 보간하는 간단한 플래너입니다. 일반적으로 빠르게 계산되지만 복잡한 모션을 지원하지 않으므로 단순한 모션에 사용됩니다.</p></li>
</ul>
<p>또한 카테시안 플래너에 특화된 일부 속성을 설정합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">sampling_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">PipelinePlanner</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node_</span><span class="p">);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">JointInterpolationPlanner</span><span class="o">&gt;</span><span class="p">();</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">cartesian_planner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">CartesianPath</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setMaxVelocityScalingFactor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setMaxAccelerationScalingFactor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">cartesian_planner</span><span class="o">-&gt;</span><span class="n">setStepSize</span><span class="p">(</span><span class="mf">.01</span><span class="p">);</span>
</pre></div>
</div>
<p>이제 플래너를 추가했으므로 로봇을 이동시킬 스테이지를 추가할 수 있습니다. 다음 줄은 <code class="docutils literal notranslate"><span class="pre">MoveTo</span></code> 스테이지(전파기 스테이지)를 사용합니다. 핸드를 여는 것은 비교적 단순한 동작이므로 관절 보간 플래너를 사용할 수 있습니다. 이 스테이지는 “open hand” 자세로 이동을 계획하는데, 이는 판다 로봇의 :moveit_resources_codedir:<code class="docutils literal notranslate"><span class="pre">SRDF&lt;panda_moveit_config/config/panda.srdf&gt;</span></code>에 정의된 명명된 자세입니다. 작업을 반환하고 createTask() 함수를 마칩니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_open_hand</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;open hand&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;open&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_open_hand</span><span class="p">));</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>마지막으로 <code class="docutils literal notranslate"><span class="pre">main</span></code> 함수가 있습니다. 다음 줄은 위에서 정의한 클래스를 사용하여 노드를 생성하고 클래스 메서드를 호출하여 기본 MTC 작업을 설정하고 실행합니다. 이 예제에서는 작업 실행이 완료된 후 RViz에서 솔루션을 검사하기 위해 실행기를 취소하지 않습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span>

<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="w"> </span><span class="n">options</span><span class="p">;</span>
<span class="w">  </span><span class="n">options</span><span class="p">.</span><span class="n">automatically_declare_parameters_from_overrides</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">mtc_task_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">MTCTaskNode</span><span class="o">&gt;</span><span class="p">(</span><span class="n">options</span><span class="p">);</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">executors</span><span class="o">::</span><span class="n">MultiThreadedExecutor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>

<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">spin_thread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="kr">thread</span><span class="o">&gt;</span><span class="p">([</span><span class="o">&amp;</span><span class="n">executor</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">mtc_task_node</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">getNodeBaseInterface</span><span class="p">());</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">spin</span><span class="p">();</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">getNodeBaseInterface</span><span class="p">());</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">setupPlanningScene</span><span class="p">();</span>
<span class="w">  </span><span class="n">mtc_task_node</span><span class="o">-&gt;</span><span class="n">doTask</span><span class="p">();</span>

<span class="w">  </span><span class="n">spin_thread</span><span class="o">-&gt;</span><span class="n">join</span><span class="p">();</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">shutdown</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h2>데모 실행<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<section id="id8">
<h3>실행 파일<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">move_group</span></code>, <code class="docutils literal notranslate"><span class="pre">ros2_control</span></code>, <code class="docutils literal notranslate"><span class="pre">static_tf</span></code>, <code class="docutils literal notranslate"><span class="pre">robot_state_publisher</span></code> 및 <code class="docutils literal notranslate"><span class="pre">rviz</span></code>를 실행하려면 실행 파일이 필요합니다. <a class="reference download internal" download="" href="../../_downloads/d5124066f25cf1d1a97945705e44aa02/mtc_demo.launch.py"><span class="xref download myst">여기</span></a>는 강의 패키지에서 사용하는 실행 파일입니다. 이 파일을 패키지의 실행 디렉토리에 넣으세요.</p>
<p>MoveIt Task Constructor 노드를 실행하려면 적절한 매개변수로 <code class="docutils literal notranslate"><span class="pre">mtc_tutorial</span></code> 실행 파일을 시작하는 두 번째 실행 파일이 필요합니다. URDF, SRDF 및 OMPL 매개변수를 로드하거나 MoveIt Configs Utils를 사용하여 로드합니다. 실행 파일은 다음과 유사해야 합니다:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">launch</span> <span class="kn">import</span> <span class="n">LaunchDescription</span>
<span class="kn">from</span> <span class="nn">launch_ros.actions</span> <span class="kn">import</span> <span class="n">Node</span>
<span class="kn">from</span> <span class="nn">moveit_configs_utils</span> <span class="kn">import</span> <span class="n">MoveItConfigsBuilder</span>

<span class="k">def</span> <span class="nf">generate_launch_description</span><span class="p">():</span>
    <span class="n">moveit_config</span> <span class="o">=</span> <span class="n">MoveItConfigsBuilder</span><span class="p">(</span><span class="s2">&quot;moveit_resources_panda&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

    <span class="c1"># MTC Demo node</span>
    <span class="n">pick_place_demo</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
        <span class="n">package</span><span class="o">=</span><span class="s2">&quot;mtc_tutorial&quot;</span><span class="p">,</span>
        <span class="n">executable</span><span class="o">=</span><span class="s2">&quot;mtc_tutorial&quot;</span><span class="p">,</span>
        <span class="n">output</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="n">parameters</span><span class="o">=</span><span class="p">[</span>
            <span class="n">moveit_config</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">LaunchDescription</span><span class="p">([</span><span class="n">pick_place_demo</span><span class="p">])</span>
</pre></div>
</div>
<p>이 파일을 <code class="docutils literal notranslate"><span class="pre">pick_place_demo.launch.py</span></code>로 패키지의 실행 디렉토리에 저장하세요. 실행 파일이 제대로 설치되도록 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>에 다음 줄을 추가해야 합니다:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>install(DIRECTORY launch DESTINATION share/${PROJECT_NAME})
</pre></div>
</div>
<p>이제 Colcon 작업 공간을 빌드하고 설정하세요:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/ws_moveit2
colcon<span class="w"> </span>build<span class="w"> </span>--mixin<span class="w"> </span>release
<span class="nb">source</span><span class="w"> </span>~/ws_moveit2/install/setup.bash
</pre></div>
</div>
<p>첫 번째 실행 파일을 실행하여 시작하세요. 강의에서 제공하는 파일을 사용하려면 다음을 실행하세요:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>moveit2_tutorials<span class="w"> </span>mtc_demo.launch.py
</pre></div>
</div>
<p>RViz가 로드되어야 합니다. 자신만의 실행 파일을 사용하는 경우 무언가를 보려면 먼저 RViz를 구성해야 합니다. 강의 패키지의 실행 파일을 사용하는 경우 이미 구성되어 있습니다.</p>
</section>
<section id="rviz">
<h3>RViz 구성<a class="headerlink" href="#rviz" title="Link to this heading">#</a></h3>
<p>RViz에서 로봇과 MoveIt Task Constructor 솔루션을 보려면 RViz 구성을 변경해야 합니다. 먼저 RViz를 시작하세요. 다음 단계에서는 MoveIt Task Constructor 솔루션 시각화를 위해 RViz를 설정하는 방법을 다룹니다.</p>
<ol class="arabic simple">
<li><p><strong>MotionPlanning</strong> 디스플레이가 활성 상태인 경우 선택을 해제하여 숨깁니다.</p></li>
<li><p><strong>Global Options</strong>에서 <strong>Fixed Frame</strong>을 <code class="docutils literal notranslate"><span class="pre">map</span></code>에서 <code class="docutils literal notranslate"><span class="pre">panda_link0</span></code>로 변경합니다(아직 변경하지 않은 경우).</p></li>
<li><p>창 왼쪽 하단의 <strong>Add</strong> 버튼을 클릭합니다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">moveit_task_constructor_visualization</span></code>에서 <strong>Motion Planning Tasks</strong>를 선택하고 OK를 클릭합니다. 왼쪽 하단에 <strong>Motion Planning Tasks</strong> 디스플레이가 나타나야 합니다.</p></li>
<li><p><strong>Displays</strong>의 <strong>Motion Planning Tasks</strong>에서 <strong>Task Solution Topic</strong>을 <code class="docutils literal notranslate"><span class="pre">/solution</span></code>으로 변경합니다.</p></li>
</ol>
<p>메인 뷰에 판다 암이 보이고 왼쪽 하단에 Motion Planning Tasks 디스플레이가 열려 있지만 아무것도 없어야 합니다. <code class="docutils literal notranslate"><span class="pre">mtc_tutorial</span></code> 노드를 실행하면 이 패널에 MTC 작업이 표시됩니다.</p>
</section>
<section id="id9">
<h3>데모 실행<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">mtc_tutorial</span></code> 노드를 다음과 같이 실행하세요:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>mtc_tutorial<span class="w"> </span>pick_place_demo.launch.py
</pre></div>
</div>
<p>로봇 앞에 녹색 실린더가 있는 상태에서 핸드를 여는 단일 스테이지로 암이 작업을 실행하는 모습을 볼 수 있습니다. 다음과 유사해야 합니다:</p>
<p><img alt="첫 번째 스테이지" src="../../_images/first_stages.png" /></p>
<p>자신만의 패키지를 만들지 않았지만 어떻게 보이는지 확인하고 싶다면 강의에서 이 파일을 실행할 수 있습니다:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>moveit2_tutorials<span class="w"> </span>mtc_demo_minimal.launch.py
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h2>스테이지 추가<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<p>지금까지 간단한 작업을 생성하고 실행하는 과정을 살펴보았습니다. 실행은 되지만 많은 작업을 수행하지는 않습니다. 이제 작업에 집어서 놓기 스테이지를 추가하기 시작할 것입니다. 아래 이미지는 작업에서 사용할 스테이지의 개요를 보여줍니다.</p>
<p><img alt="스테이지" src="../../_images/stages.png" /></p>
<p>기존 핸드 열기 스테이지 다음부터 스테이지 추가를 시작할 것입니다:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_open_hand</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;open hand&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_open_hand</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;open&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_open_hand</span><span class="p">));</span>
<span class="w">  </span><span class="c1">// 여기에 더 많은 스테이지를 정의하는 코드 줄을 추가하세요</span>
</pre></div>
</div>
<section id="id11">
<h3>집기 스테이지<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>물체를 집어들 수 있는 위치로 암을 이동해야 합니다. 이는 이름에서 알 수 있듯이 연결 역할을 하는 <code class="docutils literal notranslate"><span class="pre">Connect</span></code> 스테이지를 사용하여 수행됩니다. 즉, 이전 스테이지와 이후 스테이지의 결과 사이를 연결하려고 시도합니다. 이 스테이지는 이름 <code class="docutils literal notranslate"><span class="pre">move_to_pick</span></code>과 계획 그룹과 플래너를 지정하는 <code class="docutils literal notranslate"><span class="pre">GroupPlannerVector</span></code>로 초기화됩니다. 그런 다음 스테이지에 대한 시간 제한을 설정하고 스테이지의 속성을 설정한 후 작업에 추가합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_move_to_pick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">Connect</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">      </span><span class="s">&quot;move to pick&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">Connect</span><span class="o">::</span><span class="n">GroupPlannerVector</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">arm_group_name</span><span class="p">,</span><span class="w"> </span><span class="n">sampling_planner</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<span class="w">  </span><span class="n">stage_move_to_pick</span><span class="o">-&gt;</span><span class="n">setTimeout</span><span class="p">(</span><span class="mf">5.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">stage_move_to_pick</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">);</span>
<span class="w">  </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_move_to_pick</span><span class="p">));</span>
</pre></div>
</div>
<p>다음으로 MoveIt Task Constructor 스테이지 객체에 대한 포인터를 생성하고 현재는 <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>로 설정합니다. 나중에 이를 사용하여 스테이지를 저장할 것입니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">*</span><span class="w"> </span><span class="n">attach_object_stage</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="k">nullptr</span><span class="p">;</span><span class="w">  </span><span class="c1">// Forward attach_object_stage to place pose generator</span>
</pre></div>
</div>
<p>다음 코드 블록은 <code class="docutils literal notranslate"><span class="pre">SerialContainer</span></code>를 생성합니다. 이는 작업에 추가할 수 있는 컨테이너로 여러 하위 스테이지를 포함할 수 있습니다. 이 경우 집기 동작과 관련된 스테이지를 포함하는 직렬 컨테이너를 생성합니다. 작업에 스테이지를 추가하는 대신 관련 스테이지를 직렬 컨테이너에 추가할 것입니다. <code class="docutils literal notranslate"><span class="pre">exposeTo</span></code>를 사용하여 부모 작업의 작업 속성을 새 직렬 컨테이너에 선언하고 configureInitFrom()을 사용하여 초기화합니다. 이를 통해 포함된 스테이지에서 이러한 속성에 액세스할 수 있습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">grasp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">SerialContainer</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;pick object&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">properties</span><span class="p">().</span><span class="n">exposeTo</span><span class="p">(</span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ik_frame&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span>
<span class="w">                                          </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ik_frame&quot;</span><span class="w"> </span><span class="p">});</span>
</pre></div>
</div>
<p>그런 다음 물체에 접근하기 위한 스테이지를 생성합니다. 이 스테이지는 <code class="docutils literal notranslate"><span class="pre">MoveRelative</span></code> 스테이지로, 현재 위치에서 상대적인 이동을 지정할 수 있습니다. <code class="docutils literal notranslate"><span class="pre">MoveRelative</span></code>는 전파기 스테이지입니다. 즉, 이웃 스테이지에서 솔루션을 받아 다음 또는 이전 스테이지로 전파합니다. <code class="docutils literal notranslate"><span class="pre">cartesian_planner</span></code>를 사용하면 엔드 이펙터를 직선으로 이동하는 솔루션을 찾을 수 있습니다. 속성을 설정하고 이동할 최소 및 최대 거리를 설정합니다. 이제 이동하려는 방향을 나타내는 <code class="docutils literal notranslate"><span class="pre">Vector3Stamped</span></code> 메시지를 생성합니다. 이 경우 핸드 프레임에서 Z 방향입니다. 마지막으로 이 스테이지를 직렬 컨테이너에 추가합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveRelative</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;approach object&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cartesian_planner</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;marker_ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;approach_object&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;link&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setMinMaxDistance</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Set hand forward direction</span>
<span class="w">      </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Vector3Stamped</span><span class="w"> </span><span class="n">vec</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">vector</span><span class="p">.</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>이제 그립 자세를 생성하는 스테이지를 만듭니다. 이는 생성기 스테이지이므로 이전 및 이후 스테이지와 상관없이 결과를 계산합니다. 첫 번째 스테이지인 <code class="docutils literal notranslate"><span class="pre">CurrentState</span></code>도 생성기 스테이지입니다. 첫 번째 스테이지와 이 스테이지를 연결하려면 이미 위에서 생성한 연결 스테이지를 사용해야 합니다. 이 코드는 스테이지 속성을 설정하고 그립 전의 자세, 각도 델타 및 모니터링된 스테이지를 설정합니다. 각도 델타는 <code class="docutils literal notranslate"><span class="pre">GenerateGraspPose</span></code> 스테이지의 속성으로 생성할 자세의 수를 결정하는 데 사용됩니다. 솔루션을 생성할 때 MoveIt Task Constructor는 여러 가지 다양한 방향에서 물체를 잡으려고 시도하며, 방향 간의 차이는 각도 델타로 지정됩니다. 델타가 작을수록 그립 방향이 더 가깝게 됩니다. 현재 스테이지를 정의할 때 <code class="docutils literal notranslate"><span class="pre">current_state_ptr</span></code>을 설정하는데, 이는 이제 역기구학 솔버에 물체 자세 및 모양에 대한 정보를 전달하는 데 사용됩니다. 이 스테이지는 이전처럼 직렬 컨테이너에 직접 추가되지 않습니다. 생성된 자세에 대해 역기구학을 수행해야 하기 때문입니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Sample grasp pose</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">GenerateGraspPose</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;generate grasp pose&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;marker_ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grasp_pose&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setPreGraspPose</span><span class="p">(</span><span class="s">&quot;open&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setObject</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setAngleDelta</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setMonitoredStage</span><span class="p">(</span><span class="n">current_state_ptr</span><span class="p">);</span><span class="w">  </span><span class="c1">// Hook into current state</span>
</pre></div>
</div>
<p>위에서 생성된 자세에 대해 역기구학을 계산하기 전에 먼저 프레임을 정의해야 합니다. 이는 <code class="docutils literal notranslate"><span class="pre">geometry_msgs</span></code>의 <code class="docutils literal notranslate"><span class="pre">PoseStamped</span></code> 메시지를 사용하거나 이 경우와 같이 Eigen 변환 행렬과 관련 링크의 이름을 사용하여 변환을 정의할 수 있습니다. 여기서는 변환 행렬을 정의합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Isometry3d</span><span class="w"> </span><span class="n">grasp_frame_transform</span><span class="p">;</span>
<span class="w">      </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Quaterniond</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">AngleAxisd</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="o">::</span><span class="n">UnitX</span><span class="p">())</span><span class="w"> </span><span class="o">*</span>
<span class="w">                            </span><span class="n">Eigen</span><span class="o">::</span><span class="n">AngleAxisd</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="o">::</span><span class="n">UnitY</span><span class="p">())</span><span class="w"> </span><span class="o">*</span>
<span class="w">                            </span><span class="n">Eigen</span><span class="o">::</span><span class="n">AngleAxisd</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Eigen</span><span class="o">::</span><span class="n">Vector3d</span><span class="o">::</span><span class="n">UnitZ</span><span class="p">());</span>
<span class="w">      </span><span class="n">grasp_frame_transform</span><span class="p">.</span><span class="n">linear</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span><span class="p">.</span><span class="n">matrix</span><span class="p">();</span>
<span class="w">      </span><span class="n">grasp_frame_transform</span><span class="p">.</span><span class="n">translation</span><span class="p">().</span><span class="n">z</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
</pre></div>
</div>
<p>이제 <code class="docutils literal notranslate"><span class="pre">ComputeIK</span></code> 스테이지를 생성하고 이름 <code class="docutils literal notranslate"><span class="pre">generate</span> <span class="pre">pose</span> <span class="pre">IK</span></code>와 위에서 정의한 <code class="docutils literal notranslate"><span class="pre">generate</span> <span class="pre">grasp</span> <span class="pre">pose</span></code> 스테이지를 전달합니다. 일부 로봇은 주어진 자세에 대해 여러 개의 역기구학 솔루션을 가지고 있습니다. 최대 8개까지의 솔루션을 계산하도록 제한을 설정합니다. 또한 최소 솔루션 거리를 설정하는데, 이는 솔루션이 얼마나 달라야 하는지에 대한 임계값입니다. 솔루션의 관절 위치가 이전 솔루션과 너무 유사하면 유효하지 않은 것으로 표시됩니다. 그런 다음 일부 추가 속성을 구성하고 <code class="docutils literal notranslate"><span class="pre">ComputeIK</span></code> 스테이지를 직렬 컨테이너에 추가합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="c1">// Compute IK</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">wrapper</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ComputeIK</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;grasp pose IK&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setMaxIKSolutions</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setMinSolutionDistance</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setIKFrame</span><span class="p">(</span><span class="n">grasp_frame_transform</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">INTERFACE</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;target_pose&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">wrapper</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>물체를 집어 올리려면 핸드와 물체 사이의 충돌을 허용해야 합니다. 이는 <code class="docutils literal notranslate"><span class="pre">ModifyPlanningScene</span></code> 스테이지를 사용하여 수행할 수 있습니다. <code class="docutils literal notranslate"><span class="pre">allowCollisions</span></code> 함수를 사용하면 비활성화할 충돌을 지정할 수 있습니다. <code class="docutils literal notranslate"><span class="pre">allowCollisions</span></code>는 이름 컨테이너와 함께 사용할 수 있으므로 <code class="docutils literal notranslate"><span class="pre">getLinkModelNamesWithCollisionGeometry</span></code>를 사용하여 핸드 그룹에서 충돌 지오메트리가 있는 모든 링크의 이름을 가져올 수 있습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ModifyPlanningScene</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;allow collision (hand,object)&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">allowCollisions</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">task</span><span class="p">.</span><span class="n">getRobotModel</span><span class="p">()</span>
<span class="w">                                </span><span class="o">-&gt;</span><span class="n">getJointModelGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">)</span>
<span class="w">                                </span><span class="o">-&gt;</span><span class="n">getLinkModelNamesWithCollisionGeometry</span><span class="p">(),</span>
<span class="w">                            </span><span class="nb">true</span><span class="p">);</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>충돌이 허용되면 이제 핸드를 닫을 수 있습니다. 이는 위의 <code class="docutils literal notranslate"><span class="pre">open</span> <span class="pre">hand</span></code> 스테이지와 유사하게 <code class="docutils literal notranslate"><span class="pre">MoveTo</span></code> 스테이지를 사용하여 수행되지만, SRDF에 정의된 <code class="docutils literal notranslate"><span class="pre">close</span></code> 위치로 이동합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;close hand&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;close&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>이제 <code class="docutils literal notranslate"><span class="pre">ModifyPlanningScene</span></code> 스테이지를 다시 사용하여 <code class="docutils literal notranslate"><span class="pre">attachObject</span></code>를 사용해 물체를 핸드에 부착합니다. <code class="docutils literal notranslate"><span class="pre">current_state_ptr</span></code>에서 했던 것과 유사하게 이 스테이지에 대한 포인터를 가져와서 나중에 물체의 놓기 자세를 생성할 때 사용합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ModifyPlanningScene</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;attach object&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">attachObject</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">attach_object_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stage</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>다음으로 <code class="docutils literal notranslate"><span class="pre">approach_object</span></code> 스테이지와 유사하게 <code class="docutils literal notranslate"><span class="pre">MoveRelative</span></code> 스테이지를 사용하여 물체를 들어올립니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveRelative</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;lift object&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cartesian_planner</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setMinMaxDistance</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setIKFrame</span><span class="p">(</span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;marker_ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lift_object&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Set upward direction</span>
<span class="w">      </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Vector3Stamped</span><span class="w"> </span><span class="n">vec</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">vector</span><span class="p">.</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
<span class="w">      </span><span class="n">grasp</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>이로써 물체를 집어올리는 데 필요한 모든 스테이지가 완성되었습니다. 이제 직렬 컨테이너(모든 하위 스테이지 포함)를 작업에 추가합니다. 코드를 그대로 빌드하면 로봇이 물체를 집어올리도록 계획하는 모습을 볼 수 있습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">grasp</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>놓기 스테이지<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p>이제 집기를 정의하는 스테이지가 완료되었으므로 물체를 놓는 스테이지를 정의하는 것으로 넘어갑니다. 곧 물체를 놓을 자세를 생성하기 위해 생성기 스테이지를 사용할 것이므로 두 스테이지를 연결하는 <code class="docutils literal notranslate"><span class="pre">Connect</span></code> 스테이지로 시작합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">stage_move_to_place</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">Connect</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;move to place&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">Connect</span><span class="o">::</span><span class="n">GroupPlannerVector</span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">arm_group_name</span><span class="p">,</span><span class="w"> </span><span class="n">sampling_planner</span><span class="w"> </span><span class="p">},</span>
<span class="w">                                                  </span><span class="p">{</span><span class="w"> </span><span class="n">hand_group_name</span><span class="p">,</span><span class="w"> </span><span class="n">sampling_planner</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="n">stage_move_to_place</span><span class="o">-&gt;</span><span class="n">setTimeout</span><span class="p">(</span><span class="mf">5.0</span><span class="p">);</span>
<span class="w">    </span><span class="n">stage_move_to_place</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">);</span>
<span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage_move_to_place</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>놓기 스테이지를 위한 직렬 컨테이너도 생성합니다. 이는 집기 직렬 컨테이너와 유사하게 수행됩니다. 다음 스테이지는 작업이 아닌 직렬 컨테이너에 추가됩니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">SerialContainer</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;place object&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">properties</span><span class="p">().</span><span class="n">exposeTo</span><span class="p">(</span><span class="n">place</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">(),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ik_frame&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span>
<span class="w">                                          </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ik_frame&quot;</span><span class="w"> </span><span class="p">});</span>
</pre></div>
</div>
<p>다음 스테이지는 물체를 놓을 자세를 생성하고 해당 자세에 대한 역기구학을 계산합니다. 집기 직렬 컨테이너의 <code class="docutils literal notranslate"><span class="pre">generate</span> <span class="pre">grasp</span> <span class="pre">pose</span></code> 스테이지와 다소 유사합니다. 먼저 자세를 생성하고 작업 속성을 상속하는 스테이지를 만듭니다. <code class="docutils literal notranslate"><span class="pre">geometry_msgs</span></code>의 <code class="docutils literal notranslate"><span class="pre">PoseStamped</span></code> 메시지를 사용하여 물체를 놓을 자세를 지정합니다. 이 경우 <code class="docutils literal notranslate"><span class="pre">&quot;object&quot;</span></code> 프레임에서 <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">0.5</span></code>를 선택합니다. 그런 다음 <code class="docutils literal notranslate"><span class="pre">setPose</span></code>를 사용하여 목표 자세를 스테이지에 전달합니다. 다음으로 <code class="docutils literal notranslate"><span class="pre">setMonitoredStage</span></code>를 사용하고 이전의 <code class="docutils literal notranslate"><span class="pre">attach_object</span></code> 스테이지에 대한 포인터를 전달합니다. 이를 통해 스테이지에서 물체가 어떻게 부착되어 있는지 알 수 있습니다. 그런 다음 <code class="docutils literal notranslate"><span class="pre">GeneratePlacePose</span></code> 스테이지를 전달하여 <code class="docutils literal notranslate"><span class="pre">ComputeIK</span></code> 스테이지를 생성합니다. 나머지는 위의 집기 스테이지와 동일한 논리를 따릅니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Sample place pose</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">GeneratePlacePose</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;generate place pose&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;marker_ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;place_pose&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setObject</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">PoseStamped</span><span class="w"> </span><span class="n">target_pose_msg</span><span class="p">;</span>
<span class="w">      </span><span class="n">target_pose_msg</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;object&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="n">target_pose_msg</span><span class="p">.</span><span class="n">pose</span><span class="p">.</span><span class="n">position</span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">      </span><span class="n">target_pose_msg</span><span class="p">.</span><span class="n">pose</span><span class="p">.</span><span class="n">orientation</span><span class="p">.</span><span class="n">w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setPose</span><span class="p">(</span><span class="n">target_pose_msg</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setMonitoredStage</span><span class="p">(</span><span class="n">attach_object_stage</span><span class="p">);</span><span class="w">  </span><span class="c1">// Hook into attach_object_stage</span>

<span class="w">      </span><span class="c1">// Compute IK</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">wrapper</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ComputeIK</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;place pose IK&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setMaxIKSolutions</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setMinSolutionDistance</span><span class="p">(</span><span class="mf">1.0</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">setIKFrame</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;eef&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">wrapper</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">INTERFACE</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;target_pose&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">wrapper</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>이제 물체를 놓을 준비가 되었으므로 <code class="docutils literal notranslate"><span class="pre">MoveTo</span></code> 스테이지와 관절 보간 플래너를 사용하여 핸드를 엽니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;open hand&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;open&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>물체를 더 이상 잡을 필요가 없으므로 물체와의 충돌도 다시 활성화할 수 있습니다. 이는 충돌을 비활성화할 때와 거의 동일한 방식으로 <code class="docutils literal notranslate"><span class="pre">allowCollisions</span></code>를 사용하여 수행되지만, 마지막 인수를 <code class="docutils literal notranslate"><span class="pre">true</span></code> 대신 <code class="docutils literal notranslate"><span class="pre">false</span></code>로 설정합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ModifyPlanningScene</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;forbid collision (hand,object)&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">allowCollisions</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="n">task</span><span class="p">.</span><span class="n">getRobotModel</span><span class="p">()</span>
<span class="w">                                </span><span class="o">-&gt;</span><span class="n">getJointModelGroup</span><span class="p">(</span><span class="n">hand_group_name</span><span class="p">)</span>
<span class="w">                                </span><span class="o">-&gt;</span><span class="n">getLinkModelNamesWithCollisionGeometry</span><span class="p">(),</span>
<span class="w">                            </span><span class="nb">false</span><span class="p">);</span>
<span class="w">      </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>이제 <code class="docutils literal notranslate"><span class="pre">detachObject</span></code>를 사용하여 물체를 분리할 수 있습니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">ModifyPlanningScene</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;detach object&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">detachObject</span><span class="p">(</span><span class="s">&quot;object&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">approach</span> <span class="pre">object</span></code> 및 <code class="docutils literal notranslate"><span class="pre">lift</span> <span class="pre">object</span></code> 스테이지와 유사하게 <code class="docutils literal notranslate"><span class="pre">MoveRelative</span></code> 스테이지를 사용하여 물체에서 후퇴합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveRelative</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;retreat&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">cartesian_planner</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setMinMaxDistance</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setIKFrame</span><span class="p">(</span><span class="n">hand_frame</span><span class="p">);</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;marker_ns&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;retreat&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Set retreat direction</span>
<span class="w">      </span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Vector3Stamped</span><span class="w"> </span><span class="n">vec</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;world&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="n">vec</span><span class="p">.</span><span class="n">vector</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.5</span><span class="p">;</span>
<span class="w">      </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setDirection</span><span class="p">(</span><span class="n">vec</span><span class="p">);</span>
<span class="w">      </span><span class="n">place</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
<p>놓기 직렬 컨테이너를 마무리하고 작업에 추가합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">place</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>마지막 단계는 홈으로 돌아가는 것입니다. <code class="docutils literal notranslate"><span class="pre">MoveTo</span></code> 스테이지를 사용하고 판다 SRDF에 정의된 자세인 <code class="docutils literal notranslate"><span class="pre">ready</span></code>를 목표 자세로 전달합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mtc</span><span class="o">::</span><span class="n">stages</span><span class="o">::</span><span class="n">MoveTo</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;return home&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">interpolation_planner</span><span class="p">);</span>
<span class="w">    </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">properties</span><span class="p">().</span><span class="n">configureInitFrom</span><span class="p">(</span><span class="n">mtc</span><span class="o">::</span><span class="n">Stage</span><span class="o">::</span><span class="n">PARENT</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;group&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="n">stage</span><span class="o">-&gt;</span><span class="n">setGoal</span><span class="p">(</span><span class="s">&quot;ready&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">task</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">stage</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>이 모든 스테이지는 아래 줄 위에 추가되어야 합니다.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// 이 줄 위에 모든 스테이지가 작업에 추가됩니다</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">task</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>축하합니다! 이제 MoveIt Task Constructor를 사용하여 집어서 놓기 작업을 정의했습니다!</p>
</section>
</section>
<section id="id13">
<h2>RViz로 시각화<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>각 구성 스테이지를 포함한 작업이 Motion Planning Tasks 창에 표시됩니다. 스테이지를 클릭하면 오른쪽에 스테이지에 대한 추가 정보가 표시됩니다. 오른쪽 창에는 다양한 솔루션과 관련 비용이 표시됩니다. 스테이지 유형과 로봇 구성에 따라 하나의 솔루션만 표시될 수 있습니다.</p>
<p>솔루션 비용 중 하나를 클릭하면 해당 스테이지의 계획을 따르는 로봇의 애니메이션이 표시됩니다. 창 오른쪽 상단의 “Exec” 버튼을 클릭하여 모션을 실행합니다.</p>
<p>MoveIt 강의에 포함된 전체 MoveIt Task Constructor 예제를 실행하려면 다음을 실행하세요:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>moveit2_tutorials<span class="w"> </span>mtc_demo.launch.py
</pre></div>
</div>
<p>그리고 두 번째 터미널에서 다음을 실행하세요:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>moveit2_tutorials<span class="w"> </span>pick_place_demo.launch.py
</pre></div>
</div>
<section id="id14">
<h3>터미널에서 디버깅<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>MTC를 실행할 때 터미널에 다음과 같은 다이어그램이 출력됩니다:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>demo_node-1<span class="o">]</span><span class="w">     </span><span class="m">1</span><span class="w">  </span>-<span class="w"> </span>←<span class="w">   </span><span class="m">1</span><span class="w"> </span>→<span class="w">   </span>-<span class="w">  </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span>initial_state
<span class="o">[</span>demo_node-1<span class="o">]</span><span class="w">     </span>-<span class="w">  </span><span class="m">0</span><span class="w"> </span>→<span class="w">   </span><span class="m">0</span><span class="w"> </span>→<span class="w">   </span>-<span class="w">  </span><span class="m">0</span><span class="w"> </span>/<span class="w"> </span>move_to_home
</pre></div>
</div>
<p>이 예제는^ 두 개의 스테이지를 보여줍니다. 첫 번째 스테이지(“initial_state”)는 <code class="docutils literal notranslate"><span class="pre">CurrentState</span></code> 유형의 스테이지로, PlanningScene을 초기화하고 해당 시점에 존재하는 충돌 객체를 캡처합니다. 이 스테이지에 대한 포인터를 사용하여 로봇의 상태를 검색할 수 있습니다. CurrentState는 <code class="docutils literal notranslate"><span class="pre">Generator</span></code>에서 상속되므로 솔루션을 앞뒤로 전파합니다. 이는 양방향 화살표로 표시됩니다. 첫 번째 <code class="docutils literal notranslate"><span class="pre">1</span></code>은 하나의 솔루션이 이전 스테이지로 성공적으로 역방향 전파되었음을 나타냅니다. 화살표 사이의 두 번째 <code class="docutils literal notranslate"><span class="pre">1</span></code>은 하나의 솔루션이 생성되었음을 나타냅니다. <code class="docutils literal notranslate"><span class="pre">0</span></code>은 다음 스테이지가 실패했기 때문에 솔루션이 다음 스테이지로 성공적으로 전방 전파되지 않았음을 나타냅니다.</p>
<p>두 번째 스테이지(“move_to_home”)는 <code class="docutils literal notranslate"><span class="pre">MoveTo</span></code> 유형의 스테이지입니다. 전파 방향을 이전 스테이지에서 상속하므로 두 화살표가 모두 앞을 가리킵니다. 왼쪽에서 오른쪽으로 <code class="docutils literal notranslate"><span class="pre">0</span></code>은 다음을 의미합니다:</p>
<ul class="simple">
<li><p>스테이지가 이전 스테이지에서 솔루션을 받지 못함</p></li>
<li><p>스테이지가 솔루션을 생성하지 않음</p></li>
<li><p>스테이지가 솔루션을 다음 스테이지로 전방 전파하지 않음</p></li>
</ul>
<p>이 경우 “move_to_home”이 실패의 근본 원인임을 알 수 있습니다. 문제는 충돌이 발생한 홈 상태였습니다. 새로운 충돌이 없는 홈 위치를 정의하면 문제가 해결되었습니다.</p>
</section>
<section id="id15">
<h3>다양한 힌트<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<p>작업에서 개별 스테이지에 대한 정보를 검색할 수 있습니다. 예를 들어 여기서는 스테이지의 고유 ID를 검색합니다:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>uint32_t const unique_stage_id = task_.stages()-&gt;findChild(stage_name)-&gt;introspectionId();
</pre></div>
</div>
<p>CurrentState 유형의 스테이지는 단순히 로봇의 현재 상태를 검색하는 것이 아닙니다. 또한 PlanningScene 객체를 초기화하여 해당 시점에 존재하는 충돌 객체를 캡처합니다.</p>
<p>MTC 스테이지는 순방향과 역방향으로 전파될 수 있습니다. RViz GUI에서 화살표를 보면 스테이지가 전파되는 방향을 쉽게 확인할 수 있습니다. 역방향으로 전파할 때는 많은 작업의 논리가 반대로 됩니다. 예를 들어 <code class="docutils literal notranslate"><span class="pre">ModifyPlanningScene</span></code> 스테이지에서 물체와의 충돌을 허용하려면 <code class="docutils literal notranslate"><span class="pre">allowCollisions(true)</span></code> 대신 <code class="docutils literal notranslate"><span class="pre">allowCollisions(false)</span></code>를 호출해야 합니다. 이에 대한 논의는 <a class="reference external" href="https://github.com/ros-planning/moveit_task_constructor/issues/349">여기</a>에서 읽을 수 있습니다.</p>
</section>
</section>
<section id="id16">
<h2>요약<a class="headerlink" href="#id16" title="Link to this heading">#</a></h2>
<p>MoveIt Task Constructor를 사용하여 복잡한 집어서 놓기 작업을 구성했습니다. 이 과정에서 다음과 같은 내용을 다루었습니다:</p>
<ul class="simple">
<li><p>MoveIt Task Constructor의 개념과 스테이지 유형</p></li>
<li><p>생성기, 전파기, 연결기 스테이지를 사용하여 작업 정의</p></li>
<li><p>직렬 컨테이너를 사용하여 하위 작업 구성</p></li>
<li><p>RViz에서 작업 시각화 및 실행</p></li>
<li><p>터미널에서 MTC 디버깅</p></li>
</ul>
<p>이 강의을 통해 MoveIt Task Constructor를 사용하여 복잡한 작업을 분해하고 구성하는 방법을 배웠습니다. 이제 이 지식을 활용하여 자신만의 로봇 작업을 만들 수 있습니다.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "chu-aie/cobots-2024",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./week11/pick_and_place_with_moveit_task_constructor"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../planning_around_objects/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">물체 주변 계획하기</p>
      </div>
    </a>
    <a class="right-next"
       href="../../week12/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 12</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">시작하기</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">MoveIt Task Constructor 다운로드</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">새 패키지 만들기</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">MoveIt Task Constructor를 사용한 프로젝트 설정</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">코드</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">코드 분석</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">데모 실행</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">실행 파일</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rviz">RViz 구성</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">데모 실행</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">스테이지 추가</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">집기 스테이지</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">놓기 스테이지</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">RViz로 시각화</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">터미널에서 디버깅</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">다양한 힌트</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">요약</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href='https://entelecheia.me/'>Young Joon Lee</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <script
  data-embed-id="8ce6d27b-4248-4ca8-ac90-57f7de938b44"
  data-base-api-url="https://chat.entelecheia.app/api/embed"
  data-brand-image-url="https://assets.entelecheia.ai/favicon.png"
  data-chat-icon="magic"
  data-sponsor-text="Cobots 2024"
  data-sponsor-link="https://chat.entelecheia.app/workspace/cobots"
  src="https://chat.entelecheia.app/embed/anythingllm-chat-widget.min.js">
</script>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>